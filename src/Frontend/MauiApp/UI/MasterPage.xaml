<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MauiApp.UI.MasterPage"
             Title="Mi ColecciÃ³n"
             BackgroundColor="{AppThemeBinding Light=#f0f2f5, Dark=#121212}">

    <Grid>
        <CollectionView x:Name="cvCards"
                        ItemsSource="{Binding Cards}"
                        SelectionMode="Single"
                        SelectionChanged="cvCards_SelectionChanged"
                        RemainingItemsThreshold="5"
                        RemainingItemsThresholdReached="cvCards_RemainingItemsThresholdReached"
                        Margin="10">

            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Vertical" ItemSpacing="10" />
            </CollectionView.ItemsLayout>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame CornerRadius="12" HasShadow="True" Padding="15" Margin="0,5"
           BackgroundColor="{AppThemeBinding Light=White, Dark=#1E1E1E}"
           BorderColor="Transparent">

                        <Grid ColumnDefinitions="*, Auto, Auto" RowDefinitions="Auto, Auto, Auto">

                            <Label Text="{Binding Name}" FontSize="18" FontAttributes="Bold" 
                   TextColor="{AppThemeBinding Light=Black, Dark=White}" 
                   Grid.Column="0" Grid.Row="0"/>

                            <Label Text="{Binding Type}" FontSize="14" TextColor="{AppThemeBinding Light=#666666, Dark=#B0B0B0}" 
                   Grid.Column="0" Grid.Row="1" Margin="0,5,0,0"/>

                            <HorizontalStackLayout Grid.Row="2" Grid.Column="0" Spacing="10" Margin="0,5,0,0">
                                <Label Text="{Binding Rarity}" FontSize="12" TextColor="#512BD4" FontAttributes="Italic"/>
                                <Label Text="{Binding SetName}" FontSize="12" TextColor="Gray"/>
                            </HorizontalStackLayout>

                            <Border Grid.Column="1" Grid.Row="0" Grid.RowSpan="2" StrokeShape="RoundRectangle 15" 
                    BackgroundColor="{AppThemeBinding Light=#E1D5F5, Dark=#311B92}" Padding="10,5" VerticalOptions="Center" Margin="5,0">
                                <Label Text="{Binding ManaCost}" TextColor="{AppThemeBinding Light=#512BD4, Dark=#B39DDB}" FontAttributes="Bold" />
                            </Border>

                            <Button Text="X" 
                    Grid.Column="2" 
                    Grid.Row="0" 
                    Grid.RowSpan="3"
                    BackgroundColor="Transparent"
                    TextColor="#dc3545"
                    FontSize="20"
                    FontAttributes="Bold"
                    VerticalOptions="Center"
                    Clicked="OnDeleteClicked"/>

                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <Button Text="+" FontSize="30" WidthRequest="60" HeightRequest="60" CornerRadius="30"
                BackgroundColor="#512BD4" TextColor="White"
                HorizontalOptions="End" VerticalOptions="End"
                Margin="20"
                Shadow="{Shadow Brush=Black, Offset='2,2', Opacity=0.3}"
                Clicked="OnAddClicked" />
    </Grid>
</ContentPage>